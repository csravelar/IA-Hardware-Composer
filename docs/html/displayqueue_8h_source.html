<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IA-Hardware-Composer: common/display/displayqueue.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">IA-Hardware-Composer
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_bdd9a5d540de89e9fe90efdfc6973a4f.html">common</a></li><li class="navelem"><a class="el" href="dir_0d9364b781e31441b76a1359c89b42ee.html">display</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">displayqueue.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="displayqueue_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// Copyright (c) 2017 Intel Corporation</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// you may not use this file except in compliance with the License.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// You may obtain a copy of the License at</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//      http://www.apache.org/licenses/LICENSE-2.0</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// Unless required by applicable law or agreed to in writing, software</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// See the License for the specific language governing permissions and</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// limitations under the License.</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#ifndef COMMON_DISPLAY_DISPLAYQUEUE_H_</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#define COMMON_DISPLAY_DISPLAYQUEUE_H_</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="spinlock_8h.html">spinlock.h</a>&gt;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;stdint.h&gt;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;queue&gt;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="compositor_8h.html">compositor.h</a>&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="displayplanemanager_8h.html">displayplanemanager.h</a>&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hwcthread_8h.html">hwcthread.h</a>&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;platformdefines.h&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="resourcemanager_8h.html">resourcemanager.h</a>&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="vblankeventhandler_8h.html">vblankeventhandler.h</a>&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacehwcomposer.html">hwcomposer</a> {</div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="structhwcomposer_1_1gamma__colors.html">   37</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structhwcomposer_1_1gamma__colors.html">gamma_colors</a> {</div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="structhwcomposer_1_1gamma__colors.html#a02c6848074b1bf52bedf0a97a791fbbd">   38</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="structhwcomposer_1_1gamma__colors.html#a02c6848074b1bf52bedf0a97a791fbbd">red</a>;</div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="structhwcomposer_1_1gamma__colors.html#a920b8cb1cd029474bbbcbfae61d0feb2">   39</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="structhwcomposer_1_1gamma__colors.html#a920b8cb1cd029474bbbcbfae61d0feb2">green</a>;</div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="structhwcomposer_1_1gamma__colors.html#a3e2055501bf5bd0be915deb952f26097">   40</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="structhwcomposer_1_1gamma__colors.html#a3e2055501bf5bd0be915deb952f26097">blue</a>;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;};</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="structhwcomposer_1_1canvas__color__comps.html">   43</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structhwcomposer_1_1canvas__color__comps.html">canvas_color_comps</a> {</div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="structhwcomposer_1_1canvas__color__comps.html#acc36ffbe065c257719324261a5132a34">   44</a></span>&#160;  uint16_t <a class="code" href="structhwcomposer_1_1canvas__color__comps.html#acc36ffbe065c257719324261a5132a34">bpc</a>;</div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="structhwcomposer_1_1canvas__color__comps.html#a1fe32ff54751b722cf22aa5552bbf639">   45</a></span>&#160;  uint16_t <a class="code" href="structhwcomposer_1_1canvas__color__comps.html#a1fe32ff54751b722cf22aa5552bbf639">red</a>;</div><div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="structhwcomposer_1_1canvas__color__comps.html#ac32b9c45f1b36efde1daf1ff611f91a2">   46</a></span>&#160;  uint16_t <a class="code" href="structhwcomposer_1_1canvas__color__comps.html#ac32b9c45f1b36efde1daf1ff611f91a2">green</a>;</div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="structhwcomposer_1_1canvas__color__comps.html#a27ec3e90465f37afc780b4667553c476">   47</a></span>&#160;  uint16_t <a class="code" href="structhwcomposer_1_1canvas__color__comps.html#a27ec3e90465f37afc780b4667553c476">blue</a>;</div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="structhwcomposer_1_1canvas__color__comps.html#aa3bc7ed2376661512398ec6be09bde4e">   48</a></span>&#160;  uint16_t <a class="code" href="structhwcomposer_1_1canvas__color__comps.html#aa3bc7ed2376661512398ec6be09bde4e">alpha</a>;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;};</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keyword">class </span><a class="code" href="classhwcomposer_1_1FrameBufferManager.html">FrameBufferManager</a>;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keyword">class </span><a class="code" href="classhwcomposer_1_1PhysicalDisplay.html">PhysicalDisplay</a>;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keyword">class </span><a class="code" href="classhwcomposer_1_1DisplayPlaneHandler.html">DisplayPlaneHandler</a>;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keyword">struct </span><a class="code" href="structhwcomposer_1_1HwcLayer.html">HwcLayer</a>;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keyword">class </span><a class="code" href="classhwcomposer_1_1NativeBufferHandler.html">NativeBufferHandler</a>;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keyword">static</span> uint32_t kidleframes = 250;</div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="classhwcomposer_1_1DisplayQueue.html">   58</a></span>&#160;<span class="keyword">class </span><a class="code" href="classhwcomposer_1_1DisplayQueue.html">DisplayQueue</a> {</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <a class="code" href="classhwcomposer_1_1DisplayQueue.html#ac02bc414cc8093869e1de9cb5cddb869">DisplayQueue</a>(uint32_t gpu_fd, <span class="keywordtype">bool</span> disable_overlay,</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;               <a class="code" href="classhwcomposer_1_1NativeBufferHandler.html">NativeBufferHandler</a>* buffer_handler, <a class="code" href="classhwcomposer_1_1PhysicalDisplay.html">PhysicalDisplay</a>* display);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <a class="code" href="classhwcomposer_1_1DisplayQueue.html#ac9eb3ffff04441f086f0a17c795ce5c1">~DisplayQueue</a>();</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#a88b95def4d501f85e2a83bef8b1c832d">Initialize</a>(uint32_t pipe, uint32_t width, uint32_t height,</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                  <a class="code" href="classhwcomposer_1_1DisplayPlaneHandler.html">DisplayPlaneHandler</a>* plane_manager,</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                  <a class="code" href="classhwcomposer_1_1FrameBufferManager.html">FrameBufferManager</a>* frame_buffer_manager);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#ae3e70e00eba870771703c41b0753216a">QueueUpdate</a>(std::vector&lt;HwcLayer*&gt;&amp; source_layers, int32_t* retire_fence,</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                   <span class="keywordtype">bool</span>* ignore_clone_update, <a class="code" href="classhwcomposer_1_1PixelUploaderCallback.html">PixelUploaderCallback</a>* call_back,</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                   <span class="keywordtype">bool</span> handle_constraints);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#aa8ae9ab4014c0950196f2687ddc6fbb0">SetPowerMode</a>(uint32_t power_mode);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#a3b69d049bda17e67403bc782159a6aae">CheckPlaneFormat</a>(uint32_t format);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#a04cd89eacae444e6f626bbf0351ce23a">SetGamma</a>(<span class="keywordtype">float</span> red, <span class="keywordtype">float</span> green, <span class="keywordtype">float</span> blue);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#a212d623ab62b8b3d57a95dd6eec67869">SetColorTransform</a>(<span class="keyword">const</span> <span class="keywordtype">float</span>* matrix, <a class="code" href="hwcdefs_8h.html#a1a2c55aec4fbd12a1e323f2bdb3e9b88">HWCColorTransform</a> hint);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#a6e8b07f2613ead8eb7c15a3118e386f5">SetContrast</a>(uint32_t red, uint32_t green, uint32_t blue);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#aa7de8c877ac00ff5ab8589535eccbc12">SetBrightness</a>(uint32_t red, uint32_t green, uint32_t blue);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#ac20dcfb66475f60f8f45244592be057e">SetExplicitSyncSupport</a>(<span class="keywordtype">bool</span> disable_explicit_sync);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#af9685778a5edd676f1cb53384e45f043">SetVideoScalingMode</a>(uint32_t mode);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#af0af87df114aead2719fd8b4169262a2">SetVideoColor</a>(HWCColorControl color, <span class="keywordtype">float</span> value);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#a23e8d5eeba9ca1a1a9c1cbeef4825733">GetVideoColor</a>(HWCColorControl color, <span class="keywordtype">float</span>* value, <span class="keywordtype">float</span>* start,</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                     <span class="keywordtype">float</span>* end);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#a7da63db0845b4c79e3bd856edf4009cb">SetCanvasColor</a>(uint16_t bpc, uint16_t red, uint16_t green, uint16_t blue,</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                      uint16_t alpha);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#a899b71a818bcc2063e8fe8684e90841c">RestoreVideoDefaultColor</a>(HWCColorControl color);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#a5da13b8f765fe2e6816dcd156a363a47">SetVideoDeinterlace</a>(HWCDeinterlaceFlag flag, HWCDeinterlaceControl mode);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#a36a5b423e28bc63003dd0440dcb55e0b">RestoreVideoDefaultDeinterlace</a>();</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#a704b865c6302cfb8fcda1a593544dc92">RegisterVsyncCallback</a>(std::shared_ptr&lt;VsyncCallback&gt; callback,</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                            uint32_t display_id);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#afde8d6a7c9b823e2300dcb3d9e26765f">RegisterRefreshCallback</a>(std::shared_ptr&lt;RefreshCallback&gt; callback,</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                               uint32_t display_id);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#ae62d50d722c5cd5fe0161149db137534">VSyncControl</a>(<span class="keywordtype">bool</span> enabled);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#aac8954f6842a697c37ea023687bbcafa">HandleIdleCase</a>();</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#ae4315f2af3673e1f4065fabe897529de">DisplayConfigurationChanged</a>();</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#af3ff9ed930230b52624bbb0fea4a753c">IsIgnoreUpdates</a>();</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#a7aabbaa2b30bef9941b19694f55bc065">ForceRefresh</a>();</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#af7a7db40de2431b949dc66e757983fea">UpdateScalingRatio</a>(uint32_t primary_width, uint32_t primary_height,</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                          uint32_t display_width, uint32_t display_height);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#a385e83725a9ace5ba2444701f56230fb">SetCloneMode</a>(<span class="keywordtype">bool</span> cloned);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#aa195d43bfa58dbd7dbb4b64935d3fdc9">RotateDisplay</a>(HWCRotation rotation);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#a846279cb773b60d9c6408c95e686c479">IgnoreUpdates</a>();</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#aa7bffa150112ffae0780fce86129693f">PresentClonedCommit</a>(<a class="code" href="classhwcomposer_1_1DisplayQueue.html">DisplayQueue</a>* queue);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#acee236565010db0f1634c0771e251f88">NotifyDisplayWA</a>(<span class="keywordtype">bool</span> enable_wa);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="classhwcomposer_1_1DisplayQueue.html#a0d2c19cad60b60fd3234aa649656d889">  116</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehwcomposer.html#adf383ae435d39a5631a8ad82e7fa18a4">DisplayPlaneStateList</a>&amp; <a class="code" href="classhwcomposer_1_1DisplayQueue.html#a0d2c19cad60b60fd3234aa649656d889">GetCurrentCompositionPlanes</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">return</span> previous_plane_state_;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  }</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="classhwcomposer_1_1DisplayQueue.html#a352a161dfc0e142d06d1606ffd35863d">  120</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classhwcomposer_1_1DisplayQueue.html#a352a161dfc0e142d06d1606ffd35863d">NeedsCloneValidation</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">return</span> needs_clone_validation_;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  }</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="classhwcomposer_1_1DisplayQueue.html#a6efa456f61a20d722b2dc0860dd59296">  124</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="classhwcomposer_1_1NativeBufferHandler.html">NativeBufferHandler</a>* <a class="code" href="classhwcomposer_1_1DisplayQueue.html#a6efa456f61a20d722b2dc0860dd59296">GetNativeBufferHandler</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">if</span> (resource_manager_) {</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="keywordflow">return</span> resource_manager_-&gt;GetNativeBufferHandler();</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="alios_2platformdefines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  }</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keyword">enum</span> QueueState {</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    kNeedsColorCorrection = 1 &lt;&lt; 0,  <span class="comment">// Needs Color correction.</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    kConfigurationChanged = 1 &lt;&lt; 1,  <span class="comment">// Layers need to be re-validated.</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    kPoweredOn = 1 &lt;&lt; 2,</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    kDisableOverlayUsage = 1 &lt;&lt; 3,  <span class="comment">// Disable Overlays.</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    kIgnoreIdleRefresh = 1 &lt;&lt; 4  <span class="comment">// Ignore refresh request during idle callback.</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  };</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keyword">struct </span>ScalingTracker {</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keyword">enum</span> ScalingState {</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      kNeeedsNoSclaing = 0,  <span class="comment">// Needs no scaling.</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      kNeedsScaling = 1,     <span class="comment">// Needs scaling.</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    };</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordtype">float</span> scaling_height = 1.0;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordtype">float</span> scaling_width = 1.0;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    uint32_t scaling_state_ = ScalingTracker::kNeeedsNoSclaing;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  };</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keyword">struct </span>FrameStateTracker {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keyword">enum</span> FrameState {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      kPrepareComposition = 1 &lt;&lt; 0,  <span class="comment">// Preparing for current frame composition.</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      kPrepareIdleComposition =</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          1 &lt;&lt; 1,  <span class="comment">// Next frame should be composited using Single plane.</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      kRenderIdleDisplay = 1 &lt;&lt; 2,  <span class="comment">// We are in idle mode, disable all overlays</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                                    <span class="comment">// and use only one plane.</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      kRevalidateLayers = 1 &lt;&lt; 3,   <span class="comment">// We disabled overlay usage for idle mode,</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                                    <span class="comment">// if we are continously updating</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="comment">// frames, revalidate layers to use planes.</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      kTrackingFrames =</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;          1 &lt;&lt; 4,              <span class="comment">// Tracking frames to see when layers need to be</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                               <span class="comment">// revalidated after</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                               <span class="comment">// disabling overlays for idle case scenario.</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      kIgnoreUpdates = 1 &lt;&lt; 5  <span class="comment">// Ignore present display calls.</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    };</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    uint32_t idle_frames_ = 0;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordtype">bool</span> has_cursor_layer_ = <span class="keyword">false</span>;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    SpinLock idle_lock_;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordtype">int</span> state_ = kPrepareComposition;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    uint32_t revalidate_frames_counter_ = 0;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordtype">size_t</span> total_planes_ = 1;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  };</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keyword">struct </span>ScopedIdleStateTracker {</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    ScopedIdleStateTracker(<span class="keyword">struct</span> FrameStateTracker&amp; tracker,</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                           Compositor&amp; compositor,</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                           ResourceManager* resource_manager,</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                           <a class="code" href="classhwcomposer_1_1DisplayQueue.html#ac02bc414cc8093869e1de9cb5cddb869">DisplayQueue</a>* queue)</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        : tracker_(tracker),</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;          compositor_(compositor),</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;          resource_manager_(resource_manager),</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;          queue_(queue) {</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      tracker_.idle_lock_.lock();</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      tracker_.state_ |= FrameStateTracker::kPrepareComposition;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      tracker_.has_cursor_layer_ = <span class="keyword">false</span>;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordflow">if</span> (tracker_.state_ &amp; FrameStateTracker::kPrepareIdleComposition) {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        tracker_.state_ |= FrameStateTracker::kRenderIdleDisplay;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        tracker_.state_ &amp;= ~FrameStateTracker::kPrepareIdleComposition;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      }</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      resource_manager_-&gt;RefreshBufferCache();</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      tracker_.idle_lock_.unlock();</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordtype">bool</span> RenderIdleMode()<span class="keyword"> const </span>{</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keywordflow">return</span> tracker_.state_ &amp; FrameStateTracker::kRenderIdleDisplay;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    }</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordtype">bool</span> RevalidateLayers()<span class="keyword"> const </span>{</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="keywordflow">return</span> tracker_.state_ &amp; FrameStateTracker::kRevalidateLayers;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    }</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordtype">bool</span> TrackingFrames()<span class="keyword"> const </span>{</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="keywordflow">return</span> tracker_.state_ &amp; FrameStateTracker::kTrackingFrames;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    }</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordtype">void</span> ResetTrackerState() {</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="keywordflow">if</span> (tracker_.state_ &amp; FrameStateTracker::kIgnoreUpdates) {</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        tracker_.state_ = FrameStateTracker::kIgnoreUpdates;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        tracker_.state_ = 0;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      }</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      tracker_.revalidate_frames_counter_ = 0;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordtype">bool</span> IgnoreUpdate()<span class="keyword"> const </span>{</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="keywordflow">return</span> tracker_.state_ &amp; FrameStateTracker::kIgnoreUpdates;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    }</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordtype">void</span> FrameHasCursor() {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      tracker_.has_cursor_layer_ = <span class="keyword">true</span>;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordtype">void</span> ForceSurfaceRelease() {</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      forced_ = <span class="keyword">true</span>;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    ~ScopedIdleStateTracker() {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      tracker_.idle_lock_.lock();</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="comment">// Reset idle frame count. We want that idle frames</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="comment">// are continuous to detect idle mode scenario.</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      tracker_.idle_frames_ = 0;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      tracker_.state_ &amp;= ~FrameStateTracker::kPrepareComposition;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keywordflow">if</span> (tracker_.state_ &amp; FrameStateTracker::kRenderIdleDisplay) {</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        tracker_.state_ &amp;= ~FrameStateTracker::kRenderIdleDisplay;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        tracker_.state_ |= FrameStateTracker::kTrackingFrames;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        tracker_.revalidate_frames_counter_ = 0;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tracker_.state_ &amp; FrameStateTracker::kTrackingFrames) {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keywordflow">if</span> (tracker_.revalidate_frames_counter_ &gt; 3) {</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;          tracker_.state_ &amp;= ~FrameStateTracker::kTrackingFrames;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;          tracker_.state_ |= FrameStateTracker::kRevalidateLayers;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;          tracker_.revalidate_frames_counter_ = 0;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;          tracker_.revalidate_frames_counter_++;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        }</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tracker_.state_ &amp; FrameStateTracker::kRevalidateLayers) {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        tracker_.state_ &amp;= ~FrameStateTracker::kRevalidateLayers;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        tracker_.revalidate_frames_counter_ = 0;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      }</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      tracker_.total_planes_ = queue_-&gt;previous_plane_state_.size();</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      tracker_.idle_lock_.unlock();</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="comment">// Free any surfaces.</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      queue_-&gt;display_plane_manager_-&gt;ReleaseFreeOffScreenTargets(forced_);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="keywordflow">if</span> (resource_manager_-&gt;PreparePurgedResources())</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        compositor_.FreeResources();</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    }</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;   <span class="keyword">private</span>:</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordtype">bool</span> forced_ = <span class="keyword">false</span>;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keyword">struct </span>FrameStateTracker&amp; tracker_;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    Compositor&amp; compositor_;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    ResourceManager* resource_manager_;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <a class="code" href="classhwcomposer_1_1DisplayQueue.html#ac02bc414cc8093869e1de9cb5cddb869">DisplayQueue</a>* queue_;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  };</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="comment">// State trackers for cloned display.</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="keyword">struct </span>ScopedCloneStateTracker {</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    ScopedCloneStateTracker(Compositor&amp; compositor,</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                            ResourceManager* resource_manager,</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                            <a class="code" href="classhwcomposer_1_1DisplayQueue.html#ac02bc414cc8093869e1de9cb5cddb869">DisplayQueue</a>* queue)</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        : compositor_(compositor),</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;          resource_manager_(resource_manager),</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;          queue_(queue) {</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      resource_manager_-&gt;RefreshBufferCache();</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    }</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordtype">void</span> ForceSurfaceRelease() {</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      forced_ = <span class="keyword">true</span>;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    }</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    ~ScopedCloneStateTracker() {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="comment">// Free any surfaces.</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      queue_-&gt;display_plane_manager_-&gt;ReleaseFreeOffScreenTargets(forced_);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <span class="keywordflow">if</span> (resource_manager_-&gt;PreparePurgedResources())</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        compositor_.FreeResources();</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    }</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;   <span class="keyword">private</span>:</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordtype">bool</span> forced_ = <span class="keyword">false</span>;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    Compositor&amp; compositor_;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    ResourceManager* resource_manager_;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="classhwcomposer_1_1DisplayQueue.html#ac02bc414cc8093869e1de9cb5cddb869">DisplayQueue</a>* queue_;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  };</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keywordtype">void</span> HandleExit();</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keywordtype">bool</span> ForcePlaneValidation(<span class="keywordtype">int</span> add_index, <span class="keywordtype">int</span> remove_index,</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                            <span class="keywordtype">int</span> total_layers_size, <span class="keywordtype">size_t</span> total_planes);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keywordtype">void</span> GetCachedLayers(<span class="keyword">const</span> std::vector&lt;OverlayLayer&gt;&amp; layers,</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                       <span class="keywordtype">int</span> remove_index, <a class="code" href="namespacehwcomposer.html#adf383ae435d39a5631a8ad82e7fa18a4">DisplayPlaneStateList</a>* composition,</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                       <span class="keywordtype">bool</span>* render_layers, <span class="keywordtype">bool</span>* can_ignore_commit,</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                       <span class="keywordtype">bool</span>* needs_plane_validation,</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                       <span class="keywordtype">bool</span>* force_full_validation, <span class="keywordtype">int</span>* add_index);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordtype">void</span> SetReleaseFenceToLayers(int32_t fence,</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                               std::vector&lt;HwcLayer*&gt;&amp; source_layers);</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordtype">void</span> SetMediaEffectsState(<span class="keywordtype">bool</span> apply_effects,</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                            <span class="keyword">const</span> std::vector&lt;OverlayLayer&gt;&amp; layers,</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                            <a class="code" href="namespacehwcomposer.html#adf383ae435d39a5631a8ad82e7fa18a4">DisplayPlaneStateList</a>&amp; current_composition_planes);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordtype">void</span> UpdateOnScreenSurfaces();</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="comment">// Re-initialize all state. When we are hearing this means the</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="comment">// queue is teraing down or re-started for some reason.</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keywordtype">void</span> ResetQueue();</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordtype">void</span> HandleCommitFailure(<a class="code" href="namespacehwcomposer.html#adf383ae435d39a5631a8ad82e7fa18a4">DisplayPlaneStateList</a>&amp; current_composition_planes);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  Compositor compositor_;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  uint32_t gpu_fd_;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  uint32_t brightness_;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keywordtype">float</span> color_transform_matrix_[16];</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <a class="code" href="hwcdefs_8h.html#a1a2c55aec4fbd12a1e323f2bdb3e9b88">HWCColorTransform</a> color_transform_hint_;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  uint32_t contrast_;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  int32_t kms_fence_ = 0;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="keyword">struct </span>gamma_colors gamma_;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="keyword">struct </span>canvas_color_comps canvas_;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  std::unique_ptr&lt;VblankEventHandler&gt; vblank_handler_;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  std::unique_ptr&lt;DisplayPlaneManager&gt; display_plane_manager_;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  std::unique_ptr&lt;ResourceManager&gt; resource_manager_;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  std::vector&lt;OverlayLayer&gt; in_flight_layers_;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <a class="code" href="namespacehwcomposer.html#adf383ae435d39a5631a8ad82e7fa18a4">DisplayPlaneStateList</a> previous_plane_state_;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  FrameStateTracker idle_tracker_;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  ScalingTracker scaling_tracker_;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="comment">// shared_ptr since we need to use this outside of the thread lock (to</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="comment">// actually call the hook) and we don&#39;t want the memory freed until we&#39;re</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="comment">// done</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  std::shared_ptr&lt;RefreshCallback&gt; refresh_callback_ = <a class="code" href="alios_2platformdefines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  uint32_t refrsh_display_id_ = 0;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="keywordtype">int</span> state_ = kConfigurationChanged;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  PhysicalDisplay* display_ = <a class="code" href="alios_2platformdefines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  SpinLock power_mode_lock_;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="comment">// to disable hwclock monitoring.</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordtype">bool</span> handle_display_initializations_ = <span class="keyword">true</span>;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="keywordtype">bool</span> enable_wa_ = <span class="keyword">false</span>;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  uint32_t plane_transform_ = kIdentity;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  SpinLock video_lock_;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordtype">bool</span> requested_video_effect_ = <span class="keyword">false</span>;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keywordtype">bool</span> applied_video_effect_ = <span class="keyword">false</span>;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="comment">// Set to true when layers are validated and commit fails.</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordtype">bool</span> last_commit_failed_update_ = <span class="keyword">false</span>;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="comment">// Set to true if cloned display needs to be validated.</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordtype">bool</span> needs_clone_validation_ = <span class="keyword">false</span>;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keywordtype">bool</span> clone_mode_ = <span class="keyword">false</span>;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="comment">// Set to true if this queue needs to render the offscreen surfaces.</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="keywordtype">bool</span> clone_rendered_ = <span class="keyword">false</span>;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="comment">// Surfaces to be marked as not in use. These</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="comment">// are surfaces which are added to surfaces_not_inuse_</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="comment">// below.</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  std::vector&lt;NativeSurface*&gt; mark_not_inuse_;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="comment">// Surfaces which are currently on screen and</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="comment">// need to be marked as not in use during next</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="comment">// frame.</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  std::vector&lt;NativeSurface*&gt; surfaces_not_inuse_;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  FrameBufferManager* fb_manager_ = <a class="code" href="alios_2platformdefines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;};</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;}  <span class="comment">// namespace hwcomposer</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="preprocessor">#endif  // COMMON_DISPLAY_DISPLAYQUEUE_H_</span></div><div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_aa8ae9ab4014c0950196f2687ddc6fbb0"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#aa8ae9ab4014c0950196f2687ddc6fbb0">hwcomposer::DisplayQueue::SetPowerMode</a></div><div class="ttdeci">bool SetPowerMode(uint32_t power_mode)</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l00096">displayqueue.cpp:96</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_af7a7db40de2431b949dc66e757983fea"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#af7a7db40de2431b949dc66e757983fea">hwcomposer::DisplayQueue::UpdateScalingRatio</a></div><div class="ttdeci">void UpdateScalingRatio(uint32_t primary_width, uint32_t primary_height, uint32_t display_width, uint32_t display_height)</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l01501">displayqueue.cpp:1501</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_a04cd89eacae444e6f626bbf0351ce23a"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#a04cd89eacae444e6f626bbf0351ce23a">hwcomposer::DisplayQueue::SetGamma</a></div><div class="ttdeci">void SetGamma(float red, float green, float blue)</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l01338">displayqueue.cpp:1338</a></div></div>
<div class="ttc" id="classhwcomposer_1_1NativeBufferHandler_html"><div class="ttname"><a href="classhwcomposer_1_1NativeBufferHandler.html">hwcomposer::NativeBufferHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="nativebufferhandler_8h_source.html#l00027">nativebufferhandler.h:27</a></div></div>
<div class="ttc" id="structhwcomposer_1_1gamma__colors_html_a920b8cb1cd029474bbbcbfae61d0feb2"><div class="ttname"><a href="structhwcomposer_1_1gamma__colors.html#a920b8cb1cd029474bbbcbfae61d0feb2">hwcomposer::gamma_colors::green</a></div><div class="ttdeci">float green</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8h_source.html#l00039">displayqueue.h:39</a></div></div>
<div class="ttc" id="structhwcomposer_1_1canvas__color__comps_html_a1fe32ff54751b722cf22aa5552bbf639"><div class="ttname"><a href="structhwcomposer_1_1canvas__color__comps.html#a1fe32ff54751b722cf22aa5552bbf639">hwcomposer::canvas_color_comps::red</a></div><div class="ttdeci">uint16_t red</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8h_source.html#l00045">displayqueue.h:45</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_aa7bffa150112ffae0780fce86129693f"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#aa7bffa150112ffae0780fce86129693f">hwcomposer::DisplayQueue::PresentClonedCommit</a></div><div class="ttdeci">void PresentClonedCommit(DisplayQueue *queue)</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l00931">displayqueue.cpp:931</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayPlaneHandler_html"><div class="ttname"><a href="classhwcomposer_1_1DisplayPlaneHandler.html">hwcomposer::DisplayPlaneHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="displayplanehandler_8h_source.html#l00034">displayplanehandler.h:34</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_a352a161dfc0e142d06d1606ffd35863d"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#a352a161dfc0e142d06d1606ffd35863d">hwcomposer::DisplayQueue::NeedsCloneValidation</a></div><div class="ttdeci">bool NeedsCloneValidation() const</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8h_source.html#l00120">displayqueue.h:120</a></div></div>
<div class="ttc" id="classhwcomposer_1_1PhysicalDisplay_html"><div class="ttname"><a href="classhwcomposer_1_1PhysicalDisplay.html">hwcomposer::PhysicalDisplay</a></div><div class="ttdef"><b>Definition:</b> <a href="physicaldisplay_8h_source.html#l00041">physicaldisplay.h:41</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_a6e8b07f2613ead8eb7c15a3118e386f5"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#a6e8b07f2613ead8eb7c15a3118e386f5">hwcomposer::DisplayQueue::SetContrast</a></div><div class="ttdeci">void SetContrast(uint32_t red, uint32_t green, uint32_t blue)</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l01356">displayqueue.cpp:1356</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_a0d2c19cad60b60fd3234aa649656d889"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#a0d2c19cad60b60fd3234aa649656d889">hwcomposer::DisplayQueue::GetCurrentCompositionPlanes</a></div><div class="ttdeci">const DisplayPlaneStateList &amp; GetCurrentCompositionPlanes() const</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8h_source.html#l00116">displayqueue.h:116</a></div></div>
<div class="ttc" id="classhwcomposer_1_1PixelUploaderCallback_html"><div class="ttname"><a href="classhwcomposer_1_1PixelUploaderCallback.html">hwcomposer::PixelUploaderCallback</a></div><div class="ttdef"><b>Definition:</b> <a href="nativedisplay_8h_source.html#l00058">nativedisplay.h:58</a></div></div>
<div class="ttc" id="structhwcomposer_1_1gamma__colors_html_a02c6848074b1bf52bedf0a97a791fbbd"><div class="ttname"><a href="structhwcomposer_1_1gamma__colors.html#a02c6848074b1bf52bedf0a97a791fbbd">hwcomposer::gamma_colors::red</a></div><div class="ttdeci">float red</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8h_source.html#l00038">displayqueue.h:38</a></div></div>
<div class="ttc" id="spinlock_8h_html"><div class="ttname"><a href="spinlock_8h.html">spinlock.h</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_a212d623ab62b8b3d57a95dd6eec67869"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#a212d623ab62b8b3d57a95dd6eec67869">hwcomposer::DisplayQueue::SetColorTransform</a></div><div class="ttdeci">void SetColorTransform(const float *matrix, HWCColorTransform hint)</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l01345">displayqueue.cpp:1345</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_a88b95def4d501f85e2a83bef8b1c832d"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#a88b95def4d501f85e2a83bef8b1c832d">hwcomposer::DisplayQueue::Initialize</a></div><div class="ttdeci">bool Initialize(uint32_t pipe, uint32_t width, uint32_t height, DisplayPlaneHandler *plane_manager, FrameBufferManager *frame_buffer_manager)</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l00072">displayqueue.cpp:72</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_a3b69d049bda17e67403bc782159a6aae"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#a3b69d049bda17e67403bc782159a6aae">hwcomposer::DisplayQueue::CheckPlaneFormat</a></div><div class="ttdeci">bool CheckPlaneFormat(uint32_t format)</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l01334">displayqueue.cpp:1334</a></div></div>
<div class="ttc" id="structhwcomposer_1_1HwcLayer_html"><div class="ttname"><a href="structhwcomposer_1_1HwcLayer.html">hwcomposer::HwcLayer</a></div><div class="ttdef"><b>Definition:</b> <a href="hwclayer_8h_source.html#l00026">hwclayer.h:26</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_a36a5b423e28bc63003dd0440dcb55e0b"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#a36a5b423e28bc63003dd0440dcb55e0b">hwcomposer::DisplayQueue::RestoreVideoDefaultDeinterlace</a></div><div class="ttdeci">void RestoreVideoDefaultDeinterlace()</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l01414">displayqueue.cpp:1414</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_ae62d50d722c5cd5fe0161149db137534"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#ae62d50d722c5cd5fe0161149db137534">hwcomposer::DisplayQueue::VSyncControl</a></div><div class="ttdeci">void VSyncControl(bool enabled)</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l01443">displayqueue.cpp:1443</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_aa195d43bfa58dbd7dbb4b64935d3fdc9"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#aa195d43bfa58dbd7dbb4b64935d3fdc9">hwcomposer::DisplayQueue::RotateDisplay</a></div><div class="ttdeci">void RotateDisplay(HWCRotation rotation)</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l00123">displayqueue.cpp:123</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_ae4315f2af3673e1f4065fabe897529de"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#ae4315f2af3673e1f4065fabe897529de">hwcomposer::DisplayQueue::DisplayConfigurationChanged</a></div><div class="ttdeci">void DisplayConfigurationChanged()</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l01496">displayqueue.cpp:1496</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_a6efa456f61a20d722b2dc0860dd59296"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#a6efa456f61a20d722b2dc0860dd59296">hwcomposer::DisplayQueue::GetNativeBufferHandler</a></div><div class="ttdeci">const NativeBufferHandler * GetNativeBufferHandler() const</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8h_source.html#l00124">displayqueue.h:124</a></div></div>
<div class="ttc" id="structhwcomposer_1_1gamma__colors_html"><div class="ttname"><a href="structhwcomposer_1_1gamma__colors.html">hwcomposer::gamma_colors</a></div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8h_source.html#l00037">displayqueue.h:37</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_aac8954f6842a697c37ea023687bbcafa"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#aac8954f6842a697c37ea023687bbcafa">hwcomposer::DisplayQueue::HandleIdleCase</a></div><div class="ttdeci">void HandleIdleCase()</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l01447">displayqueue.cpp:1447</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_a7aabbaa2b30bef9941b19694f55bc065"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#a7aabbaa2b30bef9941b19694f55bc065">hwcomposer::DisplayQueue::ForceRefresh</a></div><div class="ttdeci">void ForceRefresh()</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l01483">displayqueue.cpp:1483</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_af9685778a5edd676f1cb53384e45f043"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#af9685778a5edd676f1cb53384e45f043">hwcomposer::DisplayQueue::SetVideoScalingMode</a></div><div class="ttdeci">void SetVideoScalingMode(uint32_t mode)</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l01380">displayqueue.cpp:1380</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_af0af87df114aead2719fd8b4169262a2"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#af0af87df114aead2719fd8b4169262a2">hwcomposer::DisplayQueue::SetVideoColor</a></div><div class="ttdeci">void SetVideoColor(HWCColorControl color, float value)</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l01387">displayqueue.cpp:1387</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_afde8d6a7c9b823e2300dcb3d9e26765f"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#afde8d6a7c9b823e2300dcb3d9e26765f">hwcomposer::DisplayQueue::RegisterRefreshCallback</a></div><div class="ttdeci">void RegisterRefreshCallback(std::shared_ptr&lt; RefreshCallback &gt; callback, uint32_t display_id)</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l01435">displayqueue.cpp:1435</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_ac02bc414cc8093869e1de9cb5cddb869"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#ac02bc414cc8093869e1de9cb5cddb869">hwcomposer::DisplayQueue::DisplayQueue</a></div><div class="ttdeci">DisplayQueue(uint32_t gpu_fd, bool disable_overlay, NativeBufferHandler *buffer_handler, PhysicalDisplay *display)</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l00037">displayqueue.cpp:37</a></div></div>
<div class="ttc" id="structhwcomposer_1_1canvas__color__comps_html"><div class="ttname"><a href="structhwcomposer_1_1canvas__color__comps.html">hwcomposer::canvas_color_comps</a></div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8h_source.html#l00043">displayqueue.h:43</a></div></div>
<div class="ttc" id="structhwcomposer_1_1canvas__color__comps_html_ac32b9c45f1b36efde1daf1ff611f91a2"><div class="ttname"><a href="structhwcomposer_1_1canvas__color__comps.html#ac32b9c45f1b36efde1daf1ff611f91a2">hwcomposer::canvas_color_comps::green</a></div><div class="ttdeci">uint16_t green</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8h_source.html#l00046">displayqueue.h:46</a></div></div>
<div class="ttc" id="displayplanemanager_8h_html"><div class="ttname"><a href="displayplanemanager_8h.html">displayplanemanager.h</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_acee236565010db0f1634c0771e251f88"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#acee236565010db0f1634c0771e251f88">hwcomposer::DisplayQueue::NotifyDisplayWA</a></div><div class="ttdeci">void NotifyDisplayWA(bool enable_wa)</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l01140">displayqueue.cpp:1140</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_a899b71a818bcc2063e8fe8684e90841c"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#a899b71a818bcc2063e8fe8684e90841c">hwcomposer::DisplayQueue::RestoreVideoDefaultColor</a></div><div class="ttdeci">void RestoreVideoDefaultColor(HWCColorControl color)</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l01399">displayqueue.cpp:1399</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html">hwcomposer::DisplayQueue</a></div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8h_source.html#l00058">displayqueue.h:58</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_ae3e70e00eba870771703c41b0753216a"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#ae3e70e00eba870771703c41b0753216a">hwcomposer::DisplayQueue::QueueUpdate</a></div><div class="ttdeci">bool QueueUpdate(std::vector&lt; HwcLayer *&gt; &amp;source_layers, int32_t *retire_fence, bool *ignore_clone_update, PixelUploaderCallback *call_back, bool handle_constraints)</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l00529">displayqueue.cpp:529</a></div></div>
<div class="ttc" id="alios_2platformdefines_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="alios_2platformdefines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="alios_2platformdefines_8h_source.html#l00015">platformdefines.h:15</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_a385e83725a9ace5ba2444701f56230fb"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#a385e83725a9ace5ba2444701f56230fb">hwcomposer::DisplayQueue::SetCloneMode</a></div><div class="ttdeci">void SetCloneMode(bool cloned)</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l01149">displayqueue.cpp:1149</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_a846279cb773b60d9c6408c95e686c479"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#a846279cb773b60d9c6408c95e686c479">hwcomposer::DisplayQueue::IgnoreUpdates</a></div><div class="ttdeci">void IgnoreUpdates()</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l01177">displayqueue.cpp:1177</a></div></div>
<div class="ttc" id="structhwcomposer_1_1canvas__color__comps_html_acc36ffbe065c257719324261a5132a34"><div class="ttname"><a href="structhwcomposer_1_1canvas__color__comps.html#acc36ffbe065c257719324261a5132a34">hwcomposer::canvas_color_comps::bpc</a></div><div class="ttdeci">uint16_t bpc</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8h_source.html#l00044">displayqueue.h:44</a></div></div>
<div class="ttc" id="resourcemanager_8h_html"><div class="ttname"><a href="resourcemanager_8h.html">resourcemanager.h</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_a7da63db0845b4c79e3bd856edf4009cb"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#a7da63db0845b4c79e3bd856edf4009cb">hwcomposer::DisplayQueue::SetCanvasColor</a></div><div class="ttdeci">void SetCanvasColor(uint16_t bpc, uint16_t red, uint16_t green, uint16_t blue, uint16_t alpha)</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l01421">displayqueue.cpp:1421</a></div></div>
<div class="ttc" id="hwcthread_8h_html"><div class="ttname"><a href="hwcthread_8h.html">hwcthread.h</a></div></div>
<div class="ttc" id="hwcdefs_8h_html_a1a2c55aec4fbd12a1e323f2bdb3e9b88"><div class="ttname"><a href="hwcdefs_8h.html#a1a2c55aec4fbd12a1e323f2bdb3e9b88">HWCColorTransform</a></div><div class="ttdeci">HWCColorTransform</div><div class="ttdef"><b>Definition:</b> <a href="hwcdefs_8h_source.html#l00108">hwcdefs.h:108</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_af3ff9ed930230b52624bbb0fea4a753c"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#af3ff9ed930230b52624bbb0fea4a753c">hwcomposer::DisplayQueue::IsIgnoreUpdates</a></div><div class="ttdeci">bool IsIgnoreUpdates()</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l01183">displayqueue.cpp:1183</a></div></div>
<div class="ttc" id="vblankeventhandler_8h_html"><div class="ttname"><a href="vblankeventhandler_8h.html">vblankeventhandler.h</a></div></div>
<div class="ttc" id="structhwcomposer_1_1canvas__color__comps_html_a27ec3e90465f37afc780b4667553c476"><div class="ttname"><a href="structhwcomposer_1_1canvas__color__comps.html#a27ec3e90465f37afc780b4667553c476">hwcomposer::canvas_color_comps::blue</a></div><div class="ttdeci">uint16_t blue</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8h_source.html#l00047">displayqueue.h:47</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_ac20dcfb66475f60f8f45244592be057e"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#ac20dcfb66475f60f8f45244592be057e">hwcomposer::DisplayQueue::SetExplicitSyncSupport</a></div><div class="ttdeci">void SetExplicitSyncSupport(bool disable_explicit_sync)</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l01372">displayqueue.cpp:1372</a></div></div>
<div class="ttc" id="namespacehwcomposer_html_adf383ae435d39a5631a8ad82e7fa18a4"><div class="ttname"><a href="namespacehwcomposer.html#adf383ae435d39a5631a8ad82e7fa18a4">hwcomposer::DisplayPlaneStateList</a></div><div class="ttdeci">std::vector&lt; DisplayPlaneState &gt; DisplayPlaneStateList</div><div class="ttdef"><b>Definition:</b> <a href="displayplanestate_8h_source.html#l00034">displayplanestate.h:34</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_aa7de8c877ac00ff5ab8589535eccbc12"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#aa7de8c877ac00ff5ab8589535eccbc12">hwcomposer::DisplayQueue::SetBrightness</a></div><div class="ttdeci">void SetBrightness(uint32_t red, uint32_t green, uint32_t blue)</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l01364">displayqueue.cpp:1364</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_a5da13b8f765fe2e6816dcd156a363a47"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#a5da13b8f765fe2e6816dcd156a363a47">hwcomposer::DisplayQueue::SetVideoDeinterlace</a></div><div class="ttdeci">void SetVideoDeinterlace(HWCDeinterlaceFlag flag, HWCDeinterlaceControl mode)</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l01406">displayqueue.cpp:1406</a></div></div>
<div class="ttc" id="structhwcomposer_1_1gamma__colors_html_a3e2055501bf5bd0be915deb952f26097"><div class="ttname"><a href="structhwcomposer_1_1gamma__colors.html#a3e2055501bf5bd0be915deb952f26097">hwcomposer::gamma_colors::blue</a></div><div class="ttdeci">float blue</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8h_source.html#l00040">displayqueue.h:40</a></div></div>
<div class="ttc" id="structhwcomposer_1_1canvas__color__comps_html_aa3bc7ed2376661512398ec6be09bde4e"><div class="ttname"><a href="structhwcomposer_1_1canvas__color__comps.html#aa3bc7ed2376661512398ec6be09bde4e">hwcomposer::canvas_color_comps::alpha</a></div><div class="ttdeci">uint16_t alpha</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8h_source.html#l00048">displayqueue.h:48</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_a23e8d5eeba9ca1a1a9c1cbeef4825733"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#a23e8d5eeba9ca1a1a9c1cbeef4825733">hwcomposer::DisplayQueue::GetVideoColor</a></div><div class="ttdeci">void GetVideoColor(HWCColorControl color, float *value, float *start, float *end)</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l01394">displayqueue.cpp:1394</a></div></div>
<div class="ttc" id="classhwcomposer_1_1FrameBufferManager_html"><div class="ttname"><a href="classhwcomposer_1_1FrameBufferManager.html">hwcomposer::FrameBufferManager</a></div><div class="ttdef"><b>Definition:</b> <a href="framebuffermanager_8h_source.html#l00078">framebuffermanager.h:78</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_ac9eb3ffff04441f086f0a17c795ce5c1"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#ac9eb3ffff04441f086f0a17c795ce5c1">hwcomposer::DisplayQueue::~DisplayQueue</a></div><div class="ttdeci">~DisplayQueue()</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l00069">displayqueue.cpp:69</a></div></div>
<div class="ttc" id="namespacehwcomposer_html"><div class="ttname"><a href="namespacehwcomposer.html">hwcomposer</a></div><div class="ttdef"><b>Definition:</b> <a href="compositionregion_8h_source.html#l00024">compositionregion.h:24</a></div></div>
<div class="ttc" id="classhwcomposer_1_1DisplayQueue_html_a704b865c6302cfb8fcda1a593544dc92"><div class="ttname"><a href="classhwcomposer_1_1DisplayQueue.html#a704b865c6302cfb8fcda1a593544dc92">hwcomposer::DisplayQueue::RegisterVsyncCallback</a></div><div class="ttdeci">int RegisterVsyncCallback(std::shared_ptr&lt; VsyncCallback &gt; callback, uint32_t display_id)</div><div class="ttdef"><b>Definition:</b> <a href="displayqueue_8cpp_source.html#l01430">displayqueue.cpp:1430</a></div></div>
<div class="ttc" id="compositor_8h_html"><div class="ttname"><a href="compositor_8h.html">compositor.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
