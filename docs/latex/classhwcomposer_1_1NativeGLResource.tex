\hypertarget{classhwcomposer_1_1NativeGLResource}{}\section{hwcomposer\+:\+:Native\+G\+L\+Resource Class Reference}
\label{classhwcomposer_1_1NativeGLResource}\index{hwcomposer\+::\+Native\+G\+L\+Resource@{hwcomposer\+::\+Native\+G\+L\+Resource}}


{\ttfamily \#include $<$nativeglresource.\+h$>$}

Inheritance diagram for hwcomposer\+:\+:Native\+G\+L\+Resource\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classhwcomposer_1_1NativeGLResource}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classhwcomposer_1_1NativeGLResource_af59a83a68eab750f4b7a233965aa8800}{Native\+G\+L\+Resource}} ()=default
\item 
\mbox{\hyperlink{classhwcomposer_1_1NativeGLResource_aa54cf09584732f4d1608ecb374871620}{$\sim$\+Native\+G\+L\+Resource}} () override
\item 
bool \mbox{\hyperlink{classhwcomposer_1_1NativeGLResource_a1d9a2081a910c8fbac2e15ac17f89087}{Prepare\+Resources}} (const std\+::vector$<$ \mbox{\hyperlink{classhwcomposer_1_1OverlayBuffer}{Overlay\+Buffer}} $\ast$$>$ \&buffers) override
\item 
\mbox{\hyperlink{namespacehwcomposer_a3da411c7c0213da2ce847c654bdc180d}{Gpu\+Resource\+Handle}} \mbox{\hyperlink{classhwcomposer_1_1NativeGLResource_a9aa59ce44d000463c466fc0c5f91b3d4}{Get\+Resource\+Handle}} (uint32\+\_\+t layer\+\_\+index) const override
\item 
void \mbox{\hyperlink{classhwcomposer_1_1NativeGLResource_a6a54502d70215d3c65ba23bb59ac5cef}{Release\+G\+P\+U\+Resources}} (const std\+::vector$<$ \mbox{\hyperlink{namespacehwcomposer_a963c5a1d5902d2d05710dba19af35b48}{Resource\+Handle}} $>$ \&handles) override
\end{DoxyCompactItemize}


\subsection{Detailed Description}


Definition at line 29 of file nativeglresource.\+h.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classhwcomposer_1_1NativeGLResource_af59a83a68eab750f4b7a233965aa8800}\label{classhwcomposer_1_1NativeGLResource_af59a83a68eab750f4b7a233965aa8800}} 
\index{hwcomposer\+::\+Native\+G\+L\+Resource@{hwcomposer\+::\+Native\+G\+L\+Resource}!Native\+G\+L\+Resource@{Native\+G\+L\+Resource}}
\index{Native\+G\+L\+Resource@{Native\+G\+L\+Resource}!hwcomposer\+::\+Native\+G\+L\+Resource@{hwcomposer\+::\+Native\+G\+L\+Resource}}
\subsubsection{\texorpdfstring{Native\+G\+L\+Resource()}{NativeGLResource()}}
{\footnotesize\ttfamily hwcomposer\+::\+Native\+G\+L\+Resource\+::\+Native\+G\+L\+Resource (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [default]}}

\mbox{\Hypertarget{classhwcomposer_1_1NativeGLResource_aa54cf09584732f4d1608ecb374871620}\label{classhwcomposer_1_1NativeGLResource_aa54cf09584732f4d1608ecb374871620}} 
\index{hwcomposer\+::\+Native\+G\+L\+Resource@{hwcomposer\+::\+Native\+G\+L\+Resource}!````~Native\+G\+L\+Resource@{$\sim$\+Native\+G\+L\+Resource}}
\index{````~Native\+G\+L\+Resource@{$\sim$\+Native\+G\+L\+Resource}!hwcomposer\+::\+Native\+G\+L\+Resource@{hwcomposer\+::\+Native\+G\+L\+Resource}}
\subsubsection{\texorpdfstring{$\sim$\+Native\+G\+L\+Resource()}{~NativeGLResource()}}
{\footnotesize\ttfamily hwcomposer\+::\+Native\+G\+L\+Resource\+::$\sim$\+Native\+G\+L\+Resource (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}}



Definition at line 46 of file nativeglresource.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{46                                     \{}
\DoxyCodeLine{47 \}}
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classhwcomposer_1_1NativeGLResource_a9aa59ce44d000463c466fc0c5f91b3d4}\label{classhwcomposer_1_1NativeGLResource_a9aa59ce44d000463c466fc0c5f91b3d4}} 
\index{hwcomposer\+::\+Native\+G\+L\+Resource@{hwcomposer\+::\+Native\+G\+L\+Resource}!Get\+Resource\+Handle@{Get\+Resource\+Handle}}
\index{Get\+Resource\+Handle@{Get\+Resource\+Handle}!hwcomposer\+::\+Native\+G\+L\+Resource@{hwcomposer\+::\+Native\+G\+L\+Resource}}
\subsubsection{\texorpdfstring{Get\+Resource\+Handle()}{GetResourceHandle()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacehwcomposer_a3da411c7c0213da2ce847c654bdc180d}{Gpu\+Resource\+Handle}} hwcomposer\+::\+Native\+G\+L\+Resource\+::\+Get\+Resource\+Handle (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{layer\+\_\+index }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{classhwcomposer_1_1NativeGpuResource_a3d514dcd1abfb90b874f681a7d7f50f7}{hwcomposer\+::\+Native\+Gpu\+Resource}}.



Definition at line 85 of file nativeglresource.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{86                                 \{}
\DoxyCodeLine{87   \textcolor{keywordflow}{if} (layer\_textures\_.size() < layer\_index)}
\DoxyCodeLine{88     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{89 }
\DoxyCodeLine{90   \textcolor{keywordflow}{return} layer\_textures\_.at(layer\_index);}
\DoxyCodeLine{91 \}}
\end{DoxyCode}
\mbox{\Hypertarget{classhwcomposer_1_1NativeGLResource_a1d9a2081a910c8fbac2e15ac17f89087}\label{classhwcomposer_1_1NativeGLResource_a1d9a2081a910c8fbac2e15ac17f89087}} 
\index{hwcomposer\+::\+Native\+G\+L\+Resource@{hwcomposer\+::\+Native\+G\+L\+Resource}!Prepare\+Resources@{Prepare\+Resources}}
\index{Prepare\+Resources@{Prepare\+Resources}!hwcomposer\+::\+Native\+G\+L\+Resource@{hwcomposer\+::\+Native\+G\+L\+Resource}}
\subsubsection{\texorpdfstring{Prepare\+Resources()}{PrepareResources()}}
{\footnotesize\ttfamily bool hwcomposer\+::\+Native\+G\+L\+Resource\+::\+Prepare\+Resources (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ \mbox{\hyperlink{classhwcomposer_1_1OverlayBuffer}{Overlay\+Buffer}} $\ast$$>$ \&}]{buffers }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{classhwcomposer_1_1NativeGpuResource_a3f1da37f41ff245e1bfe9e44d69a3202}{hwcomposer\+::\+Native\+Gpu\+Resource}}.



Definition at line 25 of file nativeglresource.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{26                                               \{}
\DoxyCodeLine{27   std::vector<GLuint>().swap(layer\_textures\_);}
\DoxyCodeLine{28   layer\_textures\_.reserve(buffers.size());}
\DoxyCodeLine{29   EGLDisplay egl\_display = eglGetCurrentDisplay();}
\DoxyCodeLine{30   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& buffer : buffers) \{}
\DoxyCodeLine{31     \textcolor{comment}{// Create EGLImage.}}
\DoxyCodeLine{32     \textcolor{keyword}{const} \mbox{\hyperlink{namespacehwcomposer_a963c5a1d5902d2d05710dba19af35b48}{ResourceHandle}}\& import\_image =}
\DoxyCodeLine{33         buffer->GetGpuResource(egl\_display, \textcolor{keyword}{true});}
\DoxyCodeLine{34 }
\DoxyCodeLine{35     \textcolor{keywordflow}{if} (import\_image.image\_ == EGL\_NO\_IMAGE\_KHR) \{}
\DoxyCodeLine{36       \mbox{\hyperlink{alios_2platformdefines_8h_a226d6c99e4bcfca193c095e085e9097d}{ETRACE}}(\textcolor{stringliteral}{"Failed to make import image."});}
\DoxyCodeLine{37       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{38     \}}
\DoxyCodeLine{39 }
\DoxyCodeLine{40     layer\_textures\_.emplace\_back(import\_image.texture\_);}
\DoxyCodeLine{41   \}}
\DoxyCodeLine{42 }
\DoxyCodeLine{43   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{44 \}}
\end{DoxyCode}
\mbox{\Hypertarget{classhwcomposer_1_1NativeGLResource_a6a54502d70215d3c65ba23bb59ac5cef}\label{classhwcomposer_1_1NativeGLResource_a6a54502d70215d3c65ba23bb59ac5cef}} 
\index{hwcomposer\+::\+Native\+G\+L\+Resource@{hwcomposer\+::\+Native\+G\+L\+Resource}!Release\+G\+P\+U\+Resources@{Release\+G\+P\+U\+Resources}}
\index{Release\+G\+P\+U\+Resources@{Release\+G\+P\+U\+Resources}!hwcomposer\+::\+Native\+G\+L\+Resource@{hwcomposer\+::\+Native\+G\+L\+Resource}}
\subsubsection{\texorpdfstring{Release\+G\+P\+U\+Resources()}{ReleaseGPUResources()}}
{\footnotesize\ttfamily void hwcomposer\+::\+Native\+G\+L\+Resource\+::\+Release\+G\+P\+U\+Resources (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ \mbox{\hyperlink{namespacehwcomposer_a963c5a1d5902d2d05710dba19af35b48}{Resource\+Handle}} $>$ \&}]{handles }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{classhwcomposer_1_1NativeGpuResource_aeeedb37b304fcf7d005f6f409d88e0f5}{hwcomposer\+::\+Native\+Gpu\+Resource}}.



Definition at line 49 of file nativeglresource.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{50                                               \{}
\DoxyCodeLine{51   \textcolor{keywordtype}{size\_t} purged\_size = handles.size();}
\DoxyCodeLine{52   EGLDisplay egl\_display = eglGetCurrentDisplay();}
\DoxyCodeLine{53   glBindFramebuffer(GL\_FRAMEBUFFER, 0);}
\DoxyCodeLine{54   glBindTexture(GL\_TEXTURE\_EXTERNAL\_OES, 0);}
\DoxyCodeLine{55   std::vector<GLuint> textures;}
\DoxyCodeLine{56   std::vector<GLuint> fbs;}
\DoxyCodeLine{57 }
\DoxyCodeLine{58   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < purged\_size; i++) \{}
\DoxyCodeLine{59     \textcolor{keyword}{const} \mbox{\hyperlink{namespacehwcomposer_a963c5a1d5902d2d05710dba19af35b48}{ResourceHandle}}\& handle = handles.at(i);}
\DoxyCodeLine{60     \textcolor{keywordflow}{if} (handle.image\_) \{}
\DoxyCodeLine{61       \mbox{\hyperlink{namespacehwcomposer_ad9eca82e16b82126b8288f15027d7eae}{eglDestroyImageKHR}}(egl\_display, handle.image\_);}
\DoxyCodeLine{62     \}}
\DoxyCodeLine{63 }
\DoxyCodeLine{64     \textcolor{keywordflow}{if} (handle.texture\_) \{}
\DoxyCodeLine{65       textures.emplace\_back(handle.texture\_);}
\DoxyCodeLine{66     \}}
\DoxyCodeLine{67 }
\DoxyCodeLine{68     \textcolor{keywordflow}{if} (handle.fb\_) \{}
\DoxyCodeLine{69       fbs.emplace\_back(handle.fb\_);}
\DoxyCodeLine{70     \}}
\DoxyCodeLine{71   \}}
\DoxyCodeLine{72 }
\DoxyCodeLine{73   uint32\_t textures\_size = textures.size();}
\DoxyCodeLine{74   \textcolor{keywordflow}{if} (textures\_size > 0) \{}
\DoxyCodeLine{75     glDeleteTextures(textures\_size, textures.data());}
\DoxyCodeLine{76   \}}
\DoxyCodeLine{77 }
\DoxyCodeLine{78   uint32\_t fb\_size = fbs.size();}
\DoxyCodeLine{79 }
\DoxyCodeLine{80   \textcolor{keywordflow}{if} (fb\_size > 0) \{}
\DoxyCodeLine{81     glDeleteFramebuffers(fb\_size, fbs.data());}
\DoxyCodeLine{82   \}}
\DoxyCodeLine{83 \}}
\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
common/compositor/gl/\mbox{\hyperlink{nativeglresource_8h}{nativeglresource.\+h}}\item 
common/compositor/gl/\mbox{\hyperlink{nativeglresource_8cpp}{nativeglresource.\+cpp}}\end{DoxyCompactItemize}
